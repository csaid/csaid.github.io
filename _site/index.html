<!DOCTYPE html>
<html lang="en-us">

<!--
It's bad to import d3 in every post separately (https://groups.google.com/forum/#!topic/d3-js/bwdNirt2uEU).
Importing it globally here.
Putting this up at the top, according to this controversial stack overflow answer
http://stackoverflow.com/questions/7169370/d3-js-and-document-onready
 -->
<script src="https://d3js.org/d3.v5.min.js"></script>

<link rel="stylesheet" href="/public/font-awesome-4.4.0/css/font-awesome.min.css">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
    <meta name="description" content="My name is Chris Said and I am a data scientist at Opendoor. This blog is mostly about tech, stats, and science.">
  

  <!-- To get a link preview image, just set the image attribute in your _post -->
  

  <!-- twitter standard -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@chris_said" />
  <meta name="twitter:title" content="Home" />
  <meta name="twitter:description" content="" />


  <title>
    
      The File Drawer &middot; A blog by Chris Said
    
  </title>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-67746868-1', 'auto');
    ga('send', 'pageview');
  </script>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

<!--   <body class="theme-base-cps">
 -->
  <body>

    <div class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          The File Drawer
        </a>
      </h1>
      <p class="lead">My name is Chris Said and I am a data scientist at Opendoor. This blog is mostly about tech, stats, and science.</p>

    </div>

    <nav class="sidebar-nav">

      
        <a class="sidebar-nav-item active" href="/">Home</a>
      
        <a class="sidebar-nav-item" href="/archive">Archive</a>
      
        <a class="sidebar-nav-item" href="/atom.xml">Feed</a>
      

    </nav>

    <div class="wrapper">
      <div class="inner">
        <a href = "http://www.twitter.com/Chris_Said" class="contact-button"><i class="fa fa-twitter fa-2x"></i></a>
        <a href = "https://www.linkedin.com/pub/chris-said/6b/86b/979" class="contact-button"><i class="fa fa-linkedin-square fa-2x"></i></a>
        <a href = "mailto:chris.said@gmail.com" class="contact-button"><i class="fa fa-envelope fa-2x"></i></a>
      </div>
    </div>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2019/05/18/variance_after_scaling_and_summing/">
        Variance after scaling and summing&#58; One of the most useful facts from statistics
      </a>
    </h1>

    <span class="post-date">18 May 2019</span>

    <p>What do $ R^2 $, laboratory error analysis, ensemble learning, meta-analysis, and financial portfolio risk all have in common? The answer is that they all depend on a fundamental principle of statistics that is not as widely known as it should be. Once this principle is understood, a lot of stuff starts to make more sense.</p>

<p>Here’s a sneak peek at what the principle is.</p>

<script type="math/tex; mode=display">\sigma_{p}^{2} = \sum\limits_{i} \sum\limits_{j} w_i w_j \sigma_i \sigma_j \rho_{ij}</script>

<p>Don’t worry if the formula doesn’t yet make sense! We’ll work our way up to it slowly, taking pit stops along the way at simpler formulas are that useful on their own. As we work through these principles, we’ll encounter lots of neat applications and explainers.</p>

<p>This post consists of three parts:</p>

<ul>
  <li><strong>Part 1</strong>: Sums of uncorrelated random variables: Applications to social science and laboratory error analysis</li>
  <li><strong>Part 2</strong>: Weighted sums of uncorrelated random variables: Applications to machine learning and scientific meta-analysis</li>
  <li><strong>Part 3</strong>: Correlated variables and Modern Portfolio Theory</li>
</ul>

<h2 id="part-1-sums-of-uncorrelated-random-variables-applications-to-social-science-and-laboratory-error-analysis">Part 1: Sums of uncorrelated random variables: Applications to social science and laboratory error analysis</h2>

<p>Let’s start with some simplifying conditions and assume that we are dealing with <em>uncorrelated</em> random variables. If you take two of them and add them together, the variance of their sum will equal the sum of their variances. This is amazing!</p>

<p>To demonstrate this, I’ve written some Python code that generates three arrays, each of length 1 million. The first two arrays contain samples from two normal distributions with variances 9 and 16, respectively. The third array is the sum of the first two arrays. As shown in the simulation, its variance is 25, which is equal to the sum of the variances of the first two arrays (9 + 16).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">randn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c"># 1M samples from normal distribution with variance=9</span>
<span class="k">print</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">var</span><span class="p">())</span> <span class="c"># 9</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c"># 1M samples from normal distribution with variance=16</span>
<span class="k">print</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">var</span><span class="p">())</span> <span class="c"># 16</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span>
<span class="k">print</span><span class="p">(</span><span class="n">xp</span><span class="o">.</span><span class="n">var</span><span class="p">())</span> <span class="c"># 25</span>
</code></pre></div></div>

<p>This <a href="https://en.wikipedia.org/wiki/Variance#Sum_of_uncorrelated_variables_(Bienaym%C3%A9_formula)">fact</a> was first discovered in 1853 and is known as <a href="https://en.wikipedia.org/wiki/Variance#Sum_of_uncorrelated_variables_(Bienaym%C3%A9_formula)">Bienaymé’s Formula</a>. While the code example above shows the sum of two random variables, the formula can be extended to multiple random variables as follows:</p>

<div class="box">
If $ X_p $ is a sum of uncorrelated random variables $ X_1 .. X_n $, then the variance of $ X_p $ will be

$$ \sigma_{p}^{2} = \sum{\sigma^2_i} $$

where each $ X_i $ has variance $ \sigma_i^2 $.
</div>

<p>What does the $ p $ stand for in $ X_p $? It stands for <em>portfolio</em>, which is just one of the many applications we’ll see later in this post.</p>

<h3 id="why-this-is-useful">Why this is useful</h3>
<p>Bienaymé’s result is surprising and unintuitive. But since it’s such a simple formula, it is worth committing to memory, especially because of it sheds light on so many other principles. Let’s look at two of them.</p>

<h4 id="understanding--r2--and-variance-explained">Understanding $ R^2 $ and “variance explained”</h4>
<p>Psychologists often talk about “within-group variance”, “between-group variance”, and “variance explained”. What do these terms mean?</p>

<p>Imagine a hypothetical study that measured the extraversion of 10 boys and 10 girls, where extraversion is measured on a 10-point scale (<em>Figure 1</em>. Orange bars). The boys have a mean extraversion of 4.4 and the girls have a mean extraversion 5.0. In addition, the overall variance of the data is 2.5.  We can decompose this variance into two parts:</p>

<ul>
  <li><strong>Between-group variance</strong>: Create a 20-element array where every boy is assigned to the mean boy extraversion of 4.4, and every girl is assigned to the mean girl extraversion of 5.0. The variance of this array is 0.9. (<em>Figure 1</em>. Blue bars).</li>
  <li><strong>Within-group variance</strong>: Create a 20-element array of the amount each child’s extraversion deviates from the mean value for their sex. Some of these values will be negative and some will be positive. The variance of this array is 1.6. (<em>Figure 1</em>. Pink bars).</li>
</ul>

<div class="wrapper">
  <img src="/assets/2019_variance/boy_girl_extraversion.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
  <div class="caption"><strong>Figure 1</strong>: Decomposition of extraversion scores (orange) into between-group variance (blue) and within-group variance (pink).
  </div>
</div>
<p><br /></p>

<p>If you add these arrays together, the resulting array will represent the observed data (<em>Figure 1</em>. Orange bars). The variance of the observed array is 2.5, which is exactly what is predicted by Bienaymé’s Formula. It is the sum of the variances of the two component arrays (0.9 + 1.6). Psychologists might say that sex “explains” 0.9/2.5 = 36% of the extraversion variance. Equivalently, a model of extraversion that uses sex as the only predictor would have an <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">$ R^2 $</a> of 0.36.</p>

<h4 id="error-propagation-in-laboratories">Error propagation in laboratories</h4>
<p>If you ever took a physics lab or chemistry lab back in college, you may remember having to perform <a href="http://ipl.physics.harvard.edu/wp-uploads/2013/03/PS3_Error_Propagation_sp13.pdf">error analysis</a>, in which you calculated how errors would propagate through one noisy measurement after another.</p>

<p>Physics textbooks often say that standard deviations add in “quadrature”, which just means that if you are trying to estimate some quantity that is the sum of two other measurements, and if each measurement has some error with standard deviation <script type="math/tex">\sigma_1</script> and <script type="math/tex">\sigma_2</script> respectively, the final standard deviation would be  <script type="math/tex">\sigma_{p} = \sqrt{\sigma^2_1 + \sigma^2_2}</script>. I think it’s probably easier to just use variances, as in the Bienaymé Formula, with <script type="math/tex">\sigma^2_{p} = \sigma^2_1 + \sigma^2_2</script>.</p>

<p>For example, imagine you are trying to estimate the height of two boxes stacked on top of each other (<em>Figure 2</em>). One box has a height of 1 meter with variance $ \sigma^2_1 $ = 0.01, and the other has a height of 2 meters with variance $ \sigma^2_2 $ = 0.01. Let’s further assume, perhaps optimistically, that these errors are independent. That is, if the measurement of the first box is too high, it’s not any more likely that the measurement of the second box will also be too high. If we can make these assumptions, then the total height of the two boxes will be 3 meters with variance $ \sigma^2_p $ = 0.02.</p>

<div class="wrapper">
  <img src="/assets/2019_variance/stacked_boxes.png" class="inner" style="position:relative border: #222 2px solid; max-width:50%;" />
  <div class="caption"><strong>Figure 2</strong>: Two boxes stacked on top of each other. The height of each box is measured with some variance (uncertainty). The total height is the the sum of the individual heights, and the total variance (uncertainty) is the sum of the individual variances.
  </div>
</div>
<p><br /></p>

<p>There is a key difference between the extraversion example and the stacked boxes example. In the extraversion example, we added two <em>arrays</em> that each had an observed sample variance. In the stacked boxes example, we added two <em>scalar measurements</em>, where the variance of these measurements refers to our measurement uncertainty. Since both cases have a meaningful concept of ‘variance’, the Bienaymé Formula applies to both.</p>

<h2 id="part-2-weighted-sums-of-uncorrelated-random-variables-applications-to-machine-learning-and-scientific-meta-analysis">Part 2: Weighted sums of uncorrelated random variables: Applications to machine learning and scientific meta-analysis</h2>

<p>Let’s now move on to the case of <em>weighted</em> sums of uncorrelated random variables. But before we get there, we first need to understand what happens to variance when a random variable is scaled.</p>

<div class="box">
If $ X_p $ is defined as $ X $ scaled by a factor of $ w $, then the variance $ X_p $ will be

$$ \sigma_{p}^{2} = w^2 \sigma^2 $$

where $ \sigma^2 $ is the variance of $ X $.
</div>

<p>This means that if a random variable is scaled, the scale factor on the variance will change <em>quadratically</em>. Let’s see this in code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">randn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">baseline_var</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">w</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">baseline_var</span><span class="p">)</span> <span class="o">*</span> <span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c"># Array of 1M samples from normal distribution with variance=10</span>
<span class="k">print</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">var</span><span class="p">())</span> <span class="c"># 10</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">x1</span> <span class="c"># Scale this by w=0.7</span>
<span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">baseline_var</span><span class="p">)</span> <span class="c"># 4.9 (predicted variance)</span>
<span class="k">print</span><span class="p">(</span><span class="n">xp</span><span class="o">.</span><span class="n">var</span><span class="p">())</span> <span class="c"># 4.9 (empirical variance) </span>
</code></pre></div></div>
<p>To gain some intuition for this rule, it’s helpful to think about outliers. We know that outliers have a huge effect on variance. That’s because the formula used to compute variance, $ \sum{\frac{(x_i - \bar{x})^2}{n-1}} $, squares all the deviations, and so we get really big variances when we square large deviations. With that as background, let’s think about what happens if we scale our data by 2. The outliers will spread out twice as far, which means they will have even more than twice as much impact on the variance. Similarly, if we multiply our data by 0.5, we will squash the most “damaging” part of the outliers, and so we will reduce our variance by more than a factor of two.</p>

<p>While the above principle is pretty simple, things start to get interesting when you combine it with the Bienaymé Formula in Part I:</p>

<div class="box">
If $ X_p $ is a weighted sum of uncorrelated random variables $ X_1 ... X_n $, then the variance of $ X_p $ will be 

$$ \sigma_{p}^{2} = \sum{w^2_i \sigma^2_i} $$

where each $ w_i $ is a weight on $ X_i $, and each $ X_i $ has its own variance $ \sigma_i^2 $.
</div>

<p>The above formula shows what happens when you scale and then sum random variables. The final variance is the weighted sum of the original variances, where the weights are squares of the original weights. Let’s see how this can be applied to machine learning.</p>

<h3 id="an-ensemble-model-with-equal-weights">An ensemble model with equal weights</h3>

<p>Imagine that you have built two separate models to predict car prices. While the models are unbiased, they have variance in their errors. That is, sometimes a model prediction will be too high, and sometimes a model prediction will be too low. Model 1 has a mean squared error (MSE) of \$1,000 and Model 2 has an MSE of \$2,000.</p>

<p>A valuable insight from machine learning is that you can often create a better model by simply averaging the predictions of other models. Let’s demonstrate this with simulations below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">randn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">actual</span> <span class="o">=</span> <span class="mi">20000</span> <span class="o">+</span> <span class="mi">5000</span> <span class="o">*</span> <span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">errors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">errors1</span><span class="o">.</span><span class="n">var</span><span class="p">())</span> <span class="c"># 1000</span>
<span class="n">errors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span> <span class="o">*</span> <span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">errors2</span><span class="o">.</span><span class="n">var</span><span class="p">())</span> <span class="c"># 2000</span>

<span class="c"># Note that this section could be replaced with </span>
<span class="c"># errors_ensemble = 0.5 * errors1 + 0.5 * errors2</span>
<span class="n">preds1</span> <span class="o">=</span> <span class="n">actual</span> <span class="o">+</span> <span class="n">errors1</span>
<span class="n">preds2</span> <span class="o">=</span> <span class="n">actual</span> <span class="o">+</span> <span class="n">errors2</span>
<span class="n">preds_ensemble</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">preds1</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">preds2</span>
<span class="n">errors_ensemble</span> <span class="o">=</span> <span class="n">preds_ensemble</span> <span class="o">-</span> <span class="n">actual</span>

<span class="k">print</span><span class="p">(</span><span class="n">errors_ensemble</span><span class="o">.</span><span class="n">var</span><span class="p">())</span> <span class="c"># 750. Lower than variance of component models!</span>
</code></pre></div></div>

<p>As shown in the code above, even though a good model (Model 1) was averaged with an inferior model (Model 2), the resulting Ensemble model’s MSE of \$750 is better than either of the models individually.</p>

<p>The benefits of ensembling follow directly from the weighted sum formula we saw above, <script type="math/tex">\sigma_{p}^{2} = \sum{w^2_i \sigma^2_i}</script>. To understand why, it’s helpful to think of models not as generating predictions, but rather as generating errors. Since averaging the predictions of a model corresponds to averaging the errors of the model, we can treat each model’s array of errors as samples of a random variable whose variance can be plugged in to the formula. Assuming the models are unbiased (i.e. the errors average to about zero), the formula tells us the expected MSE of the ensemble predictions. In the example above, the MSE would be</p>

<script type="math/tex; mode=display">\sigma_{p}^{2} = 0.5^2 \times 1000 + 0.5^2 \times 2000 = 750</script>

<p>which is exactly what we observed in the simulations.</p>

<p>(For a totally different intuition of why ensembling works, see <a href="https://www.opendoor.com/w/blog/why-ensembling-works-the-intuition-behind-opendoors-home-pricing">this blog post</a> that I co-wrote for my company, Opendoor.)</p>

<h3 id="an-ensemble-model-with-inverse-variance-weighting">An ensemble model with Inverse Variance Weighting</h3>

<p>In the example above, we obtained good results by using an equally-weighted average of the two models. But can we do better?</p>

<p>Yes we can! Since Model 1 was better than Model 2, we should probably put more weight on Model 1. But of course we shouldn’t put all our weight on it, because then we would throw away the demonstrably useful information from Model 2. The optimal weight must be somewhere in between 50% and 100%.</p>

<p>An effective way to find the optimal weight is to <a href="http://blog.kaggle.com/2016/12/27/a-kagglers-guide-to-model-stacking-in-practice/">build another model on top of these models</a>. However, if you can make certain assumptions (unbiased and uncorrelated errors), there’s an even simpler approach that is great for back-of-the envelope calculations and great for understanding the principles behind ensembling.</p>

<p>To find the optimal weights (assuming unbiased and uncorrelated errors), we need to minimize the variance of the ensemble errors
<script type="math/tex">\sigma_{p}^{2} = \sum{w^2_i \sigma^2_i}</script>
with the constraint that 
<script type="math/tex">\sum{w_i} = 1</script>.</p>

<p>It <a href="https://en.wikipedia.org/wiki/Inverse-variance_weighting">turns out</a> that the variance-minimizing weight for a model should be proportional to the inverse of its variance.</p>

<script type="math/tex; mode=display">w_k = \frac{\frac{1}{\sigma^2_k}}{\sum{\frac{1}{\sigma^2_i}}}</script>

<p>When we apply this method, we obtain optimal weights of <script type="math/tex">w_1</script> = 0.67 and <script type="math/tex">w_2</script> = 0.33. These weights give us an ensemble error variance of</p>

<script type="math/tex; mode=display">\sigma_{p}^{2} = 0.67^2 \times 1000 + 0.33^2 \times 2000 = 666</script>

<p>which is significantly better than the $750 variance we were getting with equal weighting.</p>

<p>This method, called <a href="https://en.wikipedia.org/wiki/Inverse-variance_weightinghttps://en.wikipedia.org/wiki/Inverse-variance_weighting">Inverse Variance Weighting</a>, can be seen in the figure below. The horizontal axis represents the weight on Model 1. The vertical axis represents the weight on Model 2. Both models are unbiased. Color represents the total error variance when the model predictions are summed, based on the formula <script type="math/tex">\sigma_{p}^{2} = \sum{w^2_i \sigma^2_i}</script>. The total variance (color) increases more rapidly as you move upward compared to rightward, indicating that Model 2 contributes more to the total variance. The diagonal line represents the constraint that <script type="math/tex">w_1 + w_2 = 1</script>. The dot represents the optimal weight as determined by Inverse Variance Weighting. As you can see, Inverse Variance Weighting picks the lightest (lowest variance) point on the line, with more weight on Model 1 than Model 2.</p>

<div class="wrapper">
  <img src="/assets/2019_variance/inverse_variance/main_fig.png" class="inner" style="position:relative border: #222 2px solid; max-width:70%;" />
  <div class="caption"><strong>Figure 3</strong>. Total error variance (color) as a function of weights on a high error model (vertical) and a low error model (horizontal). The optimal weighting (dot) puts more weight on the low error model.
  </div>
</div>
<p><br /></p>

<p>Inverse Variance Weighting is not just useful as a way to understand Machine Learning ensembles. It is also one of the core principles in scientific <a href="https://en.wikipedia.org/wiki/Meta-analysis">meta-analysis</a>, which is popular in medicine and the social sciences. When multiple scientific studies attempt to estimate some quantity, and each study has a different sample size (and hence variance of their estimate), a meta-analysis should weight the high sample size studies more. Inverse Variance Weighting is used to determine those weights.</p>

<h2 id="part-3-correlated-variables-and-modern-portfolio-theory">Part 3: Correlated variables and Modern Portfolio Theory</h2>

<p>Let’s imagine we now have three unbiased models with the following MSEs:</p>

<ul>
  <li>Model 1: MSE = 1000</li>
  <li>Model 2: MSE = 1000</li>
  <li>Model 3: MSE = 2000</li>
</ul>

<p>By Inverse Variance Weighting, we should assign more weight to the first two models, with <script type="math/tex">w_1=0.4, w_2=0.4, w_3=0.2</script>.</p>

<p>But what happens if Model 1 and Model 2 have correlated errors? For example, whenever Model 2’s predictions are too high, Model 3’s predictions tend to also be too high. In that case, maybe we don’t want to give so much weight to Models 1 and 2, since they provide somewhat redundant information. Instead we might want to <em>diversify</em> our ensemble by increasing the weight on Model 3, since it provides new independent information.</p>

<p>To determine how much weight to put on each model, we first need to determine how much total variance there will be if the errors are correlated. To do this, we need to borrow a <a href="https://en.wikipedia.org/wiki/Modern_portfolio_theory">formula</a> from the financial literature, which extends the formulas we’ve worked with before. This is the formula we’ve been waiting for.</p>

<div class="box">
If $ X_p $ is a weighted sum of (correlated or uncorrelated) random variables $ X_1 ... X_n $, then the variance of $ X_p $ will be

$$ \sigma_{p}^{2} = \sum\limits_{i} \sum\limits_{j} w_i w_j \sigma_i \sigma_j \rho_{ij} $$

where each $ w_i $ and $ w_j $ are weights assigned to $ X_i $ and $ X_j $, where each $ X_i $ and $ X_j $ have standard deviations $ \sigma_i $ and $ \sigma_j $, and where the correlation between $ X_i $ and $ X_j $ is $ \rho_{ij} $.
</div>

<p>There’s a lot to unpack here, so let’s take this step by step.</p>

<ul>
  <li><script type="math/tex">\sigma_i \sigma_j \rho_{ij}</script> is a scalar quantity representing the covariance between <script type="math/tex">X_i</script> and <script type="math/tex">X_j</script>.</li>
  <li>If none of the variables are correlated with each other, then all the cases where $ i \neq j $ will go to zero, and the formula reduces to <script type="math/tex">\sigma_{p}^{2} = \sum{w^2_i \sigma^2_i}</script>, which we have seen before.</li>
  <li>The more that two variables <script type="math/tex">X_i</script> and <script type="math/tex">X_j</script> are correlated, the more the total variance <script type="math/tex">\sigma_{p}^{2}</script> increases.</li>
  <li>If two variables <script type="math/tex">X_i</script> and <script type="math/tex">X_j</script> are anti-correlated, then the total variance decreases, since <script type="math/tex">\sigma_i \sigma_j \rho_{ij}</script> is negative.</li>
  <li>This formula can be rewritten in more compact notation as <script type="math/tex">\sigma_{p}^{2} = \vec{w}^T\Sigma \vec{w}</script>, where <script type="math/tex">\vec{w}</script> is the weight vector, and <script type="math/tex">\Sigma</script> is the covariance matrix (not a summation sign!)</li>
</ul>

<p>If you skimmed the bullet points above, go back and re-read them! They are super important.</p>

<p>To find the set of weights that minimize variance in the errors, you must minimize the above formula, with the constraint that <script type="math/tex">\sum{w_i} = 1</script>. One way to do this is to use a <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize">numerical optimization method</a>. In practice, however, it is more common to just find weights by <a href="http://blog.kaggle.com/2016/12/27/a-kagglers-guide-to-model-stacking-in-practice/">building another model on top of the base models</a></p>

<p>Regardless of how the weights are found, it will usually be the case that if Models 1 and 2 are correlated, the optimal weights will reduce redundancy and put lower weight on these models than simple Inverse Variance Weighting would suggest.</p>

<h3 id="applications-to-financial-portfolios">Applications to financial portfolios</h3>

<p>The formula above was discovered by economist <a href="https://en.wikipedia.org/wiki/Harry_Markowitz">Harry Markowitz</a> in his <a href="https://en.wikipedia.org/wiki/Modern_portfolio_theory">Modern Portfolio Theory</a>, which describes how an investor can optimally trade off between expected returns and expected risk, often measured as variance. In particular, the theory shows how to maximize expected return given a fixed variance, or minimize variance given a fixed expected return. We’ll focus on the latter.</p>

<p>Imagine you have three stocks to put in your portfolio. You plan to sell them at time $ T $, at which point you expect that Stock 1 will have gone up by 5%, with some uncertainty. You can describe your uncertainty as variance, and in the case of Stock 1, let’s say <script type="math/tex">\sigma_1^2</script> = 1. This stock, as well Stocks 2 and 3, are summarized in the table below:</p>

<table>
  <thead>
    <tr>
      <th>Stock ID</th>
      <th>Expected Return</th>
      <th>Expected Risk (<script type="math/tex">\sigma^2</script>)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>

<p>This financial example should remind you of ensembling in machine learning. In the case of ensembling, we wanted to minimize variance of the weighted sum of error arrays. In the case of financial portfolios, we want to minimize the variance of the weighted sum of scalar financial returns.</p>

<p>As before, if there are no correlations between the expected returns (i.e. if Stock 1 exceeding 5% return does not imply that Stock 2 or Stock 3 will exceed 5% return), then the total variance in the portfolio will be
<script type="math/tex">\sigma_{p}^{2} = \sum{w^2_i \sigma^2_i}</script>
and we can use Inverse Variance Weighting to obtain weights $ w_1=0.4, w_2=0.4, w_3=0.2 $.</p>

<p>However, sometimes stocks have correlated expected returns. For example, if two of the stocks are in oil companies, then one stock exceeding 5% implies the other is also likely to exceed 5%. When this happens, the total variance becomes</p>

<script type="math/tex; mode=display">\sigma_{p}^{2} = \sum\limits_{i} \sum\limits_{j} w_i w_j \sigma_i \sigma_j \rho_{ij}</script>

<p>as we saw before in the ensemble example. Since this includes an additional positive term for <script type="math/tex">w_1 w_2 \sigma_1 \sigma_2 \rho_{1,2}</script>, the expected variance is higher than in the uncorrelated case, assuming the correlations are positive. To reduce this variance, we should put less weight on Stocks 1 and 2 than we would otherwise.</p>

<p>While the example above focused on minimizing the variance of a financial portfolio, you might also be interested in having a portfolio with high return. Modern Portfolio Theory describes how a portfolio can reach any abitrary point on the <a href="https://en.wikipedia.org/wiki/Efficient_frontier">efficient frontier</a> of variance and return, but that’s outside the scope of this blog post. And as you might expect, financial markets can be more complicated than Modern Portfolio Theory suggests, but that’s also outside scope.</p>

<h2 id="summary">Summary</h2>

<p>That was a long post, but I hope that the principles described have been informative. It may be helpful to summarize them in <em>backwards</em> order, starting with the most general principle.</p>

<div class="box">

If $ X_p $ is a weighted sum of (correlated or uncorrelated) random variables $ X_1 ... X_n $, then the variance of $ X_p $ will be

$$ \sigma_{p}^{2} = \sum\limits_{i} \sum\limits_{j} w_i w_j \sigma_i \sigma_j \rho_{ij} $$

where each $ w_i $ and $ w_j $ are weights assigned to $ X_i $ and $ X_j $, where each $ X_i $ and $ X_j $ have standard deviations $ \sigma_i $ and $ \sigma_j $, and where the correlation between $ X_i $ and $ X_j $ is $ \rho_{ij} $. The term $ \sigma_i \sigma_j \rho_{ij} $ is a scalar quantity representing the covariance between $ X_i $ and $ X_j $.

<br /><br />If none of the variables are correlated, then all the cases where $ i \neq j $ go to zero, and the formula reduces to 

$$ \sigma_{p}^{2} = \sum{w^2_i \sigma^2_i} $$

And finally, if we are computing a simple sum of random variables where all the weights are 1, then the formula reduces to

$$ \sigma_{p}^{2} = \sum{\sigma^2_i} $$
</div>


    <div>
        <i class="fa fa-comment"></i> <a href="http://localhost:4000/2019/05/18/variance_after_scaling_and_summing/#disqus_thread" data-disqus-identifier="http://localhost:4000/2019/05/18/variance_after_scaling_and_summing/"></a>
        <span>&nbsp; &nbsp;</span>
        <span>
            <a class="twitter-share-button"
              href="https://twitter.com/share"
              data-url="http://localhost:4000/2019/05/18/variance_after_scaling_and_summing/"
              data-via="Chris_Said"
              data-count="none"
              data-text="Variance after scaling and summing&#58; One of the most useful facts from statistics">
            Tweet
            </a>
        </span>

    </div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2018/08/06/cone-of-confusion/">
        Using your ears and head to escape the Cone Of Confusion
      </a>
    </h1>

    <span class="post-date">06 Aug 2018</span>

    <p>One of coolest things I ever learned about sensory physiology is how the auditory system is able to locate sounds. To determine whether sound is coming from the right or left, the brain uses inter-ear differences in amplitude and timing. As shown in the figure below, if the sound is louder in the right ear compared to the left ear, it’s probably coming from the right side. The smaller that difference is, the closer the sound is to the midline (i.e the vertical plane going from your front to your back). Similarly, if the sound arrives at your right ear before the left ear, it’s probably coming from the right. The smaller the timing difference, the closer it is to the midline. There’s a <a href="https://en.wikipedia.org/wiki/Coincidence_detection_in_neurobiology#Sound_localization">fascinating</a> <a href="https://nba.uth.tmc.edu/homepage/cnjclub/2004spring/McAlpineGrothe2003.pdf">literature</a> on the neural mechanisms behind this.</p>
<div class="wrapper">
  <img src="/assets/2018_cone_of_confusion/right_and_front_right.png" class="inner" style="position:relative border: #222 2px solid; max-width:50%;" />
</div>
<p>Inter-ear loudness and timing differences are pretty useful, but unfortunately they still leave a lot of ambiguity. For example, a sound from your front right will have the exact same loudness differences and timing differences as a sound from your back right.</p>
<div class="wrapper">
  <img src="/assets/2018_cone_of_confusion/front_right_and_back_right.png" class="inner" style="position:relative border: #222 2px solid; max-width:50%;" />
</div>
<p>Not only does this system leave ambiguities between front and back, it also leaves ambiguities between top and down. In fact, there is an entire <em>cone of confusion</em> that cannot be disambiguated by this system. Sound from all points along the surface of the cone will have the same inter-ear loudness differences and timing differences.</p>
<div class="wrapper">
  <img src="/assets/2018_cone_of_confusion/cone_of_confusion.png" class="inner" style="position:relative border: #222 2px solid; max-width:50%;" />
</div>
<p>While this system leaves a cone of confusion, humans are still able to determine the location of sounds from different points on the cone, at least to some extent. How are we able to do this?</p>

<p>Amazingly, we are able to do this because of the shape of our ears and heads. When sound passes through our ears and head, certain frequencies are attenuated more than others. Critically, the attenuation pattern is highly dependent on sound direction.</p>

<p>This location-dependent attenuation pattern is called a <a href="https://en.wikipedia.org/wiki/Head-related_transfer_function">Head-related transfer function</a> (HRTF) and in theory this could be used to disambiguate locations along the cone of confusion. An example of someone’s HRTF is shown below, with frequency on the horizontal axis and polar angle on the vertical axis. Hotter colors represent less attenuation (i.e. more power). If your head and ears gave you this HRTF, you might decide a sound is coming from the front if it has more high frequency power than you’d expect.</p>
<div class="wrapper">
  <img src="/assets/2018_cone_of_confusion/cone_and_hrtf.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
  <div class="caption">
    HRTF image from Simon Carlile's <a href="https://sonification.de/handbook/download/TheSonificationHandbook-chapter3.pdf">Psychoacoustics chapter</a> in The Sonification Handbook.
  </div>
</div>
<p><br />
This system sounds good in theory, but do we actually use these cues in practice? In 1988, Frederic Wightman and Doris Kistler performed an ingenious set of experiments (<a href="http://public.vrac.iastate.edu/~charding/audio/Headphone%20simulation%20of%20free-field%20listening.%20I-%20Stimulus%20synthesis%20-%20J%20Acoust%20Soc%20Am%201989%20-%20Wightman.pdf">1</a>, <a href="http://public.vrac.iastate.edu/~charding/audio/Headphone%20simulation%20of%20free-field%20listening.%20II-%20Psychophysical%20validation%20-%20J%20Acoust%20Soc%20Am%201989%20-%20Wightman.pdf">2</a>) to show that that people really do use HRTFs to infer location. First, they measured the HRTF of each participant by putting a small microphone in their ears and playing sounds from different locations. Next they created a digital filter for each location and each participant. That is to say, these filters implemented each participant’s HRTF. Finally, they placed headphones on the listeners and played sounds to them, each time passing the sound through one of the digital filters. Amazingly, participants were able to correctly guess the “location” of the sound, depending on which filter was used, even though the sound was coming from headphones. They were also much better at sound localization when using their own HRTF, rather than someone else’s HRTF.</p>

<p>Further evidence for this hypothesis comes from <a href="https://doi.org/10.1038/1633">Hofman et al., 1998</a>, who showed that by using putty to reshape people’s ears, they were able to change the HRTFs and thus disrupt sound localization. Interestingly, people were able to quickly relearn how to localize sound with their new HRTFs.</p>
<div class="wrapper">
  <img src="/assets/2018_cone_of_confusion/putty.png" class="inner" style="position:relative border: #222 2px solid; max-width:50%;" />
  <div class="caption">
    Image from <a href="https://doi.org/10.1038/1633">Hofman et al., 1998</a>.
  </div>
</div>
<p><br /></p>

<p>A final fun fact: to improve the sound localization of humanoid robots, researchers in Japan attached <a href="https://doi.org/10.1007/s10489-014-0544-y">artificial ears to the robot heads</a> and implemented some sophisticated algorithms to infer sound location. Here are some pictures of the robots.</p>
<div class="wrapper">
  <img src="/assets/2018_cone_of_confusion/robots.png" class="inner" style="position:relative border: #222 2px solid; max-width:50%;" />
</div>
<p>Their paper is kind of ridiculous and has some questionable justifications for not just using microphones in multiple locations, but I thought it was fun to see these principles being applied.</p>



    <div>
        <i class="fa fa-comment"></i> <a href="http://localhost:4000/2018/08/06/cone-of-confusion/#disqus_thread" data-disqus-identifier="http://localhost:4000/2018/08/06/cone-of-confusion/"></a>
        <span>&nbsp; &nbsp;</span>
        <span>
            <a class="twitter-share-button"
              href="https://twitter.com/share"
              data-url="http://localhost:4000/2018/08/06/cone-of-confusion/"
              data-via="Chris_Said"
              data-count="none"
              data-text="Using your ears and head to escape the Cone Of Confusion">
            Tweet
            </a>
        </span>

    </div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2018/02/04/hyperbolic-discounting/">
        Hyperbolic discounting — The irrational behavior that might be rational after all
      </a>
    </h1>

    <span class="post-date">04 Feb 2018</span>

    <p></p>
<p>When I was in grad school I occasionally overheard people talk about how humans do something called “hyperbolic discounting”. Apparently, hyperbolic discounting was considered irrational under standard economic theory.</p>

<p>I recently decided to learn what hyperbolic discounting was all about, so I set out to write this blog post. I have to admit that hyperbolic discounting has been pretty hard for me to understand, but I think I now finally have a good enough handle on it to write about it. Along the way, I learned something interesting: Hyperbolic discounting might be rational after all.</p>

<h2 id="rational-and-irrational-discounting">Rational and irrational discounting</h2>
<p>If I offered you <span class="tex2jax_ignore">$</span>50 now or <span class="tex2jax_ignore">$</span>100 in 6 months, which would you pick? It’s not crazy to choose the <span class="tex2jax_ignore">$</span>50 now. One reason is that it’s a safer bet. If you had chosen the delayed <span class="tex2jax_ignore">$</span>100, there’s a risk that I might forget about the deal when the time came to pay <em>[personal note: I wouldn’t]</em>, and you would never get your money. Another reason is that if you invest the $50 now, you might be able to make up some of the remainder in interest.</p>

<p>Valuing immediate money more than future money is a rational behavior known as discounting. Everybody has their own discount factor. Some people might value money in 6 months at, say, 75% of what they’d value it today. Others might value it at 90%.</p>

<p>In the early 1980s, psychologist George Ainslie discovered something peculiar. He <a href="https://en.wikipedia.org/wiki/Hyperbolic_discounting#Observations">found</a> that while a lot of people would prefer <span class="tex2jax_ignore">$</span>50 immediately rather than <span class="tex2jax_ignore">$</span>100 in 6 months, they would <em>not</em> prefer <span class="tex2jax_ignore">$</span>50 in 3 months rather than <span class="tex2jax_ignore">$</span>100 in 9 months. These two different scenarios are shown in the diagram below, where the green checks indicate the options that people tended to choose.</p>

<div class="wrapper">
  <img src="/assets/2018_hyperbolic_discounting/timeline_diagram.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
</div>

<p>If you think about it, there’s something inconsistent about this behavior. The two scenarios are actually identical, just shifted by 3 months, and yet the same people behave differently depending on when the scenario would be presented. If we waited 3 months and then asked them again if they would prefer <span class="tex2jax_ignore">$</span>50 immediately or <span class="tex2jax_ignore">$</span>100 in 6 months, their original response to Scenario 1 implies they would prefer the fast money (i.e. they would have a high discount rate), but their original response to Scenario 2 implies they would prefer the delayed money (i.e. they would have a low discount rate). In other words, their present self today would make a decision in Scenario 2 that three months from now they will have regretted making. This behavior is <em>time-inconsistent</em> and is therefore considered irrational according to standard economic theory.</p>

<p>The usual way to achieve rational time-consistent discounting is with an exponential discount curve, where the value of receiving something at future time <script type="math/tex">t</script> is a fixed fraction <script type="math/tex">s(t)</script> of its present value, and where <script type="math/tex">\lambda</script> is the constant discount rate.</p>

<script type="math/tex; mode=display">s(t) = e^{-\lambda t}</script>

<p>With an exponential curve, a dollar delayed by six months is always worth the same fixed fraction of a dollar at the baseline date, no matter what the baseline date it is. If you are indifferent between <span class="tex2jax_ignore">$</span>100 now and <span class="tex2jax_ignore">$</span>50 in 6 months, you should also be indifferent between <span class="tex2jax_ignore">$</span>100 in 3 months and <span class="tex2jax_ignore">$</span>50 in 9 months. The discount rate is constant.</p>

<div class="wrapper">
  <img src="/assets/2018_hyperbolic_discounting/fig_exp_fracs.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
</div>

<p>In contrast to an exponential curve, humans tend to show a <a href="https://en.wikipedia.org/wiki/Hyperbolic_discounting">hyperbolic discount curve</a>, which is considered irrational according to standard economic theory. Confusingly, the hyperbolic discount curve is not defined by one of the <a href="https://en.wikipedia.org/wiki/Hyperbolic_function">hyperbolic functions</a> you may remember from high school. Instead, it is defined as follows, where $ \tau $ is the relative time from now:</p>

<script type="math/tex; mode=display">s(\tau) = \frac{1}{1+k \tau}</script>

<p>Whereas an exponential curve has a constant discount rate, a hyperbolic discount curve has a higher discount rate in the near future and lower discount rate in the distant future. That’s why the participants in Ainslie’s experiment cared more about the delay from 0 to 6 months than about the same delay from 3 to 9 months.</p>

<div class="wrapper">
  <img src="/assets/2018_hyperbolic_discounting/fig_exp_and_hyp.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
</div>

<p>The apparent rationality of an exponential function is often presented either with a hazard rate interpretation or an interest rate interpretation. It turns out, however, that both of these interpretations make implausible assumptions about the world. The rest of this blog post describes how if we make some more plausible assumptions, hyperbolic discount function becomes rational.</p>

<h2 id="hazard-rate-interpretation">Hazard Rate interpretation</h2>

<p>According to the hazard-based interpretation of discounting, you should prefer immediate money to future money because there is a risk that the future money will never be delivered. This interpretation is more common in the animal behavior literature. (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2648524/">Pigeons</a>, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2648524/">rats</a>, and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3107575/">monkeys</a> all show hyperbolic discounting.)</p>

<h5 id="apparent-rationality-of-exponential-discounting">Apparent rationality of exponential discounting</h5>

<p>Imagine that there could be an event at some time that could cause you to no longer receive your reward. Perhaps the person who owes you the money could die or lose their assets. Assuming a constant hazard rate (i.e. assuming the event is equally likely to happen at any time), the probability that the event has not happened by time $ \tau $ is:</p>

<script type="math/tex; mode=display">s(\tau) = e^{-\lambda \tau}</script>

<p>The <script type="math/tex">s(\tau)</script> function is called a “survival” function because it describes the probability that the deal is still “alive” by time <script type="math/tex">\tau</script>. The <script type="math/tex">\lambda</script> parameter is the constant hazard rate.</p>

<div class="wrapper">
  <img src="/assets/2018_hyperbolic_discounting/fig_exp_survival.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
</div>

<p>A key insight here is that the survival function can also be interpreted as a discount function. If someone says you can receive your reward at time $ \tau $ if you’re willing to wait for it, and if there’s only a 60% chance you’ll actually receive it, you should value that offer at 60% of the current value of the reward. Since the survival function is exponential, and since the survival function <em>is</em> the discount function, your discount function is also exponential, at least according to standard economic theory.</p>

<h5 id="rationality-of-hyperbolic-discounting">Rationality of hyperbolic discounting</h5>

<p>The problem with assuming an exponential survival function is that it assumes you know the hazard rate $ \lambda $. In most situations, you don’t know exactly what the hazard rate is. Instead you have uncertainty around the parameter. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1689473/pdf/T9KA20YDP8PB1QP4_265_2015.pdf">Souza (2015)</a> proposes an exponential prior distribution over the hazard rate.</p>

<script type="math/tex; mode=display">p(\lambda) = \frac{1}{k} e^{-\frac{\lambda}{k}}</script>

<p>The exponential prior is shown in the graph below. Although this curve looks like a discount function, it is not. It is a distribution over a parameter.</p>

<div class="wrapper">
  <img src="/assets/2018_hyperbolic_discounting/fig_hazard_prior.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
</div>

<p>According to Souza, if you average over all the possible exponential survival functions generated by this prior, you get a hyperbolic survival function, or equivalently, a hyperbolic discount function. Let’s see this in action.</p>

<p>In the plot below, I’ve drawn 30 exponential survival functions in blue, each with a <script type="math/tex">\lambda</script> sampled from the <script type="math/tex">p(\lambda)</script> prior distribution defined above. The pink curve is the mean of all of them. Notice that whereas the individual survival curves are all exponential, their mean is hyperbolic, with a distant future characterized by a flat slope and relatively high survival values.</p>

<div class="wrapper">
  <img src="/assets/2018_hyperbolic_discounting/fig_mean_of_exponentials.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
</div>

<p>As a consequence, the further you look into the future, the lower your discount rate. This is exactly what hyperbolic discounting is and exactly what humans do. For the choice between <span class="tex2jax_ignore">$</span>50 now and <span class="tex2jax_ignore">$</span>100 in 6 months, we apply a heavy discount rate. For the choice between <span class="tex2jax_ignore">$</span>50 in 3 months and <span class="tex2jax_ignore">$</span>100 in 9 months, we apply a lighter discount rate.</p>

<p>For a more qualitative intuition, you can think of it this way: When you make a deal with someone, you don’t know what the hazard rate is going to be. But if the deal is still alive after 80 months, then your hazard rate is probably favorable and thus the deal is likely to still be alive after 100 months. You can therefore have a light discount rate between 80 months and 100 months.</p>

<h2 id="interest-rate-interpretation">Interest Rate interpretation</h2>

<p>While hazard functions are one way to explain discounting, another common explanation involves interest rates. A dollar now is worth more than a dollar in a year, because if you take the dollar now and invest it, it will worth more in a year.</p>

<h5 id="apparent-rationality-of-exponential-discounting-1">Apparent rationality of exponential discounting</h5>
<p>If the interest rate is 5%, you should be indifferent between <span class="tex2jax_ignore">$</span>100 today and <span class="tex2jax_ignore">$</span>105 in a year, since you could just invest the <span class="tex2jax_ignore">$</span>100 today and get the same amount in a year. If the interest rate is constant, the value of the dollar will rise exponentially, according to $ v(\tau) = e^{0.05\tau} $, where $ v $ is the value. To rationally maintain indifference between a dollar and its equivalent value in the future after investment, your discount function should decay exponentially, according to $ s(\tau) = e^{-0.05\tau} $.</p>

<h5 id="rationality-of-hyperbolic-discounting-1">Rationality of hyperbolic discounting</h5>
<p>The problem with this story is that it only works if you assume that the interest rate is constant. In the real world, the interest rate fluctuates.</p>

<p>Before taking on the fluctuating interest rate scenario, let’s first take on a different assumption that is still somewhat simplified. Let’s assume that the interest rate is constant but we don’t know what it is, just as we didn’t know what the hazard rate was in the previous interpretation. With this assumption, the justification for hyperbolic discounting becomes similar to the explanation in the blue and pink plots above. When you do a probability-weighted average over these decaying exponential curves, you get a hyperbolic function.</p>

<p>The previous paragraph assumed that the interest rate was constant but unknown. In the real world, the interest rate is known but fluctuates over time. <a href="https://campuspress.yale.edu/johngeanakoplos/files/2017/07/Hyperbolic-Discounting-is-Rational-Valuing-the-Far-Future-with-Uncertain-Discount-Rates-1uc47ft.pdf">Farmer and Geanakoplos (2009)</a> showed that if you assume that interest rate fluctuations follow a <a href="http://sfb649.wiwi.hu-berlin.de/fedc_homepage/xplore/tutorials/sfehtmlnode21.html">geometric random walk</a>, hyperbolic discounting becomes optimal, at least asymptotically as <script type="math/tex">\tau \rightarrow \infty</script>. In the near future, you know the interest rate with reasonable certainty and should therefore discount with an exponential curve. But as you look further into the future, your uncertainty about the interest rate increases and you should therefore discount with a hyperbolic curve.</p>

<p>Is the geometric random walk a process that was cherry picked by the authors to produce this outcome? Not really. <a href="https://dukespace.lib.duke.edu/dspace/bitstream/handle/10161/7542/NewellPizerDiscountingPew.pdf?sequence=1">Newell and Pizer (2003)</a> studied US bond rates in the 19th and 20th century and found that the geometric random walk provided a better fit than any of the other interest rate models tested.</p>

<h2 id="summary">Summary</h2>
<p>When interpreting discounting as a survival function, a hyperbolic discounting function is rational if you introduce uncertainty into the hazard parameter via an exponential prior (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1689473/pdf/T9KA20YDP8PB1QP4_265_2015.pdf">Souza, 2015</a>). When interpreting the discount rate as an interest rate, a hyperbolic discounting function is asymptotically rational if you introduce uncertainty in the interest rate via a geometric random walk (<a href="https://campuspress.yale.edu/johngeanakoplos/files/2017/07/Hyperbolic-Discounting-is-Rational-Valuing-the-Far-Future-with-Uncertain-Discount-Rates-1uc47ft.pdf">Farmer and Geanakoplos, 2009</a>).</p>



    <div>
        <i class="fa fa-comment"></i> <a href="http://localhost:4000/2018/02/04/hyperbolic-discounting/#disqus_thread" data-disqus-identifier="http://localhost:4000/2018/02/04/hyperbolic-discounting/"></a>
        <span>&nbsp; &nbsp;</span>
        <span>
            <a class="twitter-share-button"
              href="https://twitter.com/share"
              data-url="http://localhost:4000/2018/02/04/hyperbolic-discounting/"
              data-via="Chris_Said"
              data-count="none"
              data-text="Hyperbolic discounting — The irrational behavior that might be rational after all">
            Tweet
            </a>
        </span>

    </div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2017/12/02/religions-as-firms/">
        Religions as firms
      </a>
    </h1>

    <span class="post-date">02 Dec 2017</span>

    <p>I recently came across a magazine that helps pastors manage the financial and operational challenges of church management. The magazine is called <em>Church Executive</em>.</p>

<p>Readers concerned about seasonal effects on tithing can learn how to “<a href="https://churchexecutive.com/archives/church-executive-remote-roundtable-2">sustain generosity</a>” during the weaker summer months. Technology like <a href="https://churchexecutive.com/archives/church-executive-remote-roundtable-6">push notifications and text messages</a> is encouraged as a way to remind people to tithe. There is also some emphasis on messaging, as pastors are told to “make sure your <a href="https://churchexecutive.com/archives/church-executive-remote-roundtable-6">generosity-focused sermons</a> are hitting home with your audience”.</p>

<div class="wrapper">
  <img src="/assets/2017_religions_as_firms/church_executive.jpg" height="250" class="inner" style="position:relative border: #222 2px solid;" />
</div>

<p>Churches need money to stay active, and it’s natural that pastors would want to maintain a healthy cash flow. But the brazen language of <em>Church Executive</em> reminded me of the language of profit-maximizing firms. This got me thinking: What are the other ways in which religions act like a business?</p>

<p>This post is my attempt to understand religions as if they were businesses. This isn’t a perfect metaphor. Most religious leaders are motivated by genuine beliefs, and few are motivated primarily by profit. But it can still be instructive to view religions through the lens of business and economics, if only as an exercise. After working through this myself, I feel like I have a better understanding of why religions act the way they do.</p>

<h3 id="competition">Competition</h3>
<p>As with any business, one of the most pressing concerns of a religion is competition. According to sociologist Carl Bankston, the set of religions <a href="https://en.wikipedia.org/wiki/Theory_of_religious_economy">can be described</a> as a marketplace of competing firms that vie for customers. Religious consumers can leave one church to go to another. To hedge their bets on the afterlife, some consumers may even belong to several churches simultaneously, in a strategy that has been described as “<a href="http://users.clas.ufl.edu/kenwald/pos6292/iannaccone.pdf">portfolio diversification</a>”.</p>

<p>One way that a religion can ward off competitors is to prohibit its members from following them. The Bible is insistent on this point, with <a href="https://bible.knowing-jesus.com/topics/Avoiding-Idolatry">26 separate verses</a> banning idolatry. Other religions have been able to eliminate competition entirely by forming <a href="https://en.wikipedia.org/wiki/Islam_in_Saudi_Arabia#Role_in_the_state_and_society">state-sponsored monopolies</a>.</p>

<h3 id="pricing">Pricing</h3>
<p>Just like a business, religions need to determine how to price their product. According to economists <a href="https://www.researchgate.net/profile/Feler_Bose/publication/271328680_Funding_the_Faiths_Toward_a_Theory_of_Religious_Finance/links/54c5b8790cf219bbe4f59dac.pdf">Laurence Iannaccone and Feler Bose</a>, the optimal pricing strategy for a religion depends on whether it is proselytizing or non-proselytizing.</p>

<p>Non-proselytizing religions like Judaism and Hinduism earn much of their income from <a href="http://www.hinducenterofvirginia.org/Membership.html">membership fees</a>. While exceptions are often made for people who are too poor to pay, and while donations are still accepted, the explicit nature of the membership fees help these religions avoid having too many <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.483.5309&amp;rep=rep1&amp;type=pdf">free riders</a>.</p>

<p>Proselytizing religions like Christianity are <a href="http://freakonomics.com/2010/10/19/churches-versus-synagogues-voluntary-donations-versus-dues/">different</a>. Because of their strong emphasis on growth, they are willing to forgo explicit membership fees and instead rely more on donations that are up to the member’s discretion. Large donations from wealthy individuals can <a href="https://www.researchgate.net/profile/Feler_Bose/publication/271328680_Funding_the_Faiths_Toward_a_Theory_of_Religious_Finance/links/54c5b8790cf219bbe4f59dac.pdf">cross-subsidize</a> the membership of those who make smaller donations. Even free riders who make no donations at all <a href="https://www.economics.uci.edu/files/docs/workingpapers/2006-07/06-07-22.pdf">may be worthwhile</a>, since they may attract more members in the future.</p>

<h3 id="surge-pricing">Surge Pricing</h3>
<p>Like Uber, some religions raise the price during periods of peak demand. While attendance at Jewish synagogue for a regular Shabbat service is normally free, attendance during one of the High Holidays typically <a href="http://www.nytimes.com/2013/09/14/us/selling-holy-day-tickets-is-dilemma-for-synagogues.html">requires a payment</a> for seating, in part to <a href="https://reformjudaism.org/jewish-holidays/rosh-hashanah/five-things-know-about-attending-high-holiday-services">ensure space for everyone</a>.</p>

<div class="wrapper">
  <img src="/assets/2017_religions_as_firms/traffic_synagogue.png" class="inner" style="position:relative border: #222 2px solid; max-width:100%;" />
</div>

<p>Surge pricing makes sense for non-proselytizing religions such as Judaism, but it does not make sense for proselytizing religions such as Christianity, which views the higher demand during peak season as an <a href="https://www.researchgate.net/profile/Feler_Bose/publication/271328680_Funding_the_Faiths_Toward_a_Theory_of_Religious_Finance/links/54c5b8790cf219bbe4f59dac.pdf">opportunity</a> to convert newcomers and to reactivate lapsed members. Thus, Christian churches tend to expand seating and schedule extra services during Christmas and Easter, rather than charging fees.</p>

<h3 id="product-quality">Product Quality</h3>
<p>Just as business consumers will <a href="https://books.google.com/books/about/Acts_of_Faith.html?id=913O9xcpBB4C&amp;printsec=frontcover&amp;source=kp_read_button#v=onepage&amp;q=%22higher%20prices%22&amp;f=false">pay</a> higher prices for better products, consumers of polytheistic religions will pay higher “prices” for gods with more wide-ranging powers. Even today, some American megachurches have found success with the <a href="https://en.wikipedia.org/wiki/Prosperity_theology">prosperity gospel</a>, which emphasizes that God can make you wealthy.</p>

<p>Of course, not all religious consumers will prefer the cheap promises of the prosperity gospel. For many religions, product quality is defined primarily by community, a sense of meaning, and in some cases the promise of an afterlife.</p>

<h3 id="software-updates">Software Updates</h3>
<p>A good business should be constantly updating its product to fix bugs and to respond to changes in consumer preference or government regulation. Some religions do the same thing, via the process of <a href="https://en.wikipedia.org/wiki/Continuous_revelation">continuous revelation</a> from their deity. Perhaps no church exemplifies this better than the Church of Jesus Christ of Latter-day Saints.</p>

<p>For most of the history of the Mormon Church, individuals of African descent were prohibited from serving as priests. By the 1960s, as civil rights protests against the church received media attention, the policy became increasingly untenable. On June 1, 1978, Mormon leaders reported that God had instructed them to update the policy and allow black priests. This event was known as the <a href="https://en.wikipedia.org/wiki/1978_Revelation_on_Priesthood">1978 Revelation on the Priesthood</a>.</p>

<p>In the late 19th Century, when the Mormon Church was under intense pressure from the US Government regarding polygamy, the Church president claimed to receive a revelation from Jesus Christ asking him to prohibit it. This revelation, known as the <a href="https://en.wikipedia.org/wiki/1890_Manifesto">1890 Revelation</a>, overturned the previous <a href="https://en.wikipedia.org/wiki/Origin_of_Latter_Day_Saint_polygamy#1843_revelation">1843 Revelation</a> which allowed polygamy.</p>

<p>While frequent updates usually make sense in business, they don’t always make sense in religion. Most religions have a fairly static doctrine, as the prospect of future updates undermines the authority of current doctrine.</p>

<h3 id="growth-and-marketing">Growth and marketing</h3>
<p>Instead of focusing only on immediate profitability, many businesses invest in user growth. As mentioned earlier, many religions are willing to <a href="https://www.researchgate.net/profile/Feler_Bose/publication/271328680_Funding_the_Faiths_Toward_a_Theory_of_Religious_Finance/links/54c5b8790cf219bbe4f59dac.pdf">cross-subsidize</a> participation from new members, especially young members, with older members bearing most of the costs.</p>

<p>Christianity’s concept of a heaven and hell encouraged its members to convert their friends and family. In some ways, this is reminiscent of <a href="https://en.wikipedia.org/wiki/Viral_marketing">viral marketing</a>.</p>

<h3 id="international-expansion">International expansion</h3>
<p>Facebook and Netflix both experienced rapid adoption, starting with a U.S. audience. But as U.S. growth began to slow down, both companies needed to look towards international expansion.</p>

<p>A similar thing happened with the Mormon church. By the 20th century, U.S. growth was driven only by increasing family sizes, so the church turned towards international expansion.</p>

<p>The graph below shows similar US and international growth curves for Netflix and the Church of Jesus Christ of Latter-day Saints.<sup>[<a href="https://en.wikipedia.org/wiki/The_Church_of_Jesus_Christ_of_Latter-day_Saints_membership_history">1</a>,<a href="https://rsc.byu.edu/archived/latter-day-saint-social-life-social-research-lds-church-and-its-members/4-vital-statistics">2</a>,<a href="http://www.churchistrue.com/blog/lds-membership-statistics-report-2017/">3</a>,<a href="http://www.businessinsider.com/netflix-subscribers-international-vs-us-earnings-chart-2017-7">4</a>]</sup></p>

<div class="wrapper">
  <img src="/assets/2017_religions_as_firms/LDS_netflix.png" style="position:relative border: #222 2px solid; max-width:100%;" />
</div>

<h3 id="branding">Branding</h3>
<p>Like any company, most religions try to maintain a good brand. But unlike businesses, most religions do not have brand protection, and thus their brands can be co-opted by other religions. Marketing from Mormons and from Jehovah’s Witnesses tends to <a href="https://www.jw.org/en/jehovahs-witnesses/faq/jehovah-witness-beliefs/">emphasize</a> the good brand of Jesus Christ, even though most mainstream Christians regard these churches as heretical.</p>

<div class="wrapper">
  <img src="/assets/2017_religions_as_firms/follow_the_christ.jpg" height="250" class="inner" style="position:relative border: #222 2px solid;" />
</div>

<p>One of the most interesting risks to brands is <a href="https://en.wikipedia.org/wiki/Generic_trademark"><em>genericide</em></a>, in which a popular trademark becomes synonymous with the general class of product, thereby diluting its distinctive meaning. Famous examples of generic trademarks include Kleenex and Band-Aid. Amazingly, genericide can also happen to religious deities. The ancient Near East god <a href="https://en.wikipedia.org/wiki/El_(deity)"><em>El</em></a> began as a distinct god with followers, but <a href="https://twitter.com/suchaone/status/869909666217607168">gradually became a generic name for “God”</a> and eventually merged with the Hebrew god Yahweh.</p>

<h3 id="mergers-and-spin-offs">Mergers and spin-offs</h3>
<p>In business, companies can spin off other companies or merge with other companies. But with rare exceptions, religions only seem to have spin-offs. Why do religions hardly ever merge with other religions? My guess is that since there is no protection for religious intellectual property, religions can acquire the intellectual property of another religion without requiring a merger. Religions can simply copy each other’s ideas.</p>

<p>Another reason that religious mergers are rare is that religions are strongly tied to personal identity and tap into tribal thinking. When WhatsApp was acquired, its leadership was happy to adopt new identities as Facebook employees. But it is far less likely that members of, say, the Syriac Catholic Church would ever tolerate merging into the rival Syriac Maronite Church, even if it might provide them with economies of scale and more political power.</p>

<p>On Twitter, I asked why there are so few religious mergers and got lots of interesting <a href="https://twitter.com/Chris_Said/status/936635424012828672">responses</a>. People pointed out that reconciliation of doctrine could <a href="https://twitter.com/KyleCSN/status/936637304688427009">undermine the authority</a> of the leaders, and that there is <a href="https://twitter.com/AcostaRomay/status/936635959453585408">little benefit</a> from economies of scale. Others noted that religious mergers aren’t that rare. Hinduism and Judaism may have <a href="https://twitter.com/imrankhan/status/936648636158611456">began</a> as mergers of smaller religions, many <a href="https://twitter.com/thechelleshock/status/937033585638326272">Christian traditions</a> involve mergers with religions they replaced, and that even today Hinduism <a href="https://twitter.com/venusatuluri/status/936664575591583745">continues to be</a> a merging of various sects.</p>

<hr />

<p>It’s worth repeating that economic explanations aren’t always great at describing the <em>conscious</em> motivations of religious individuals, who generally have sincere beliefs. Nevertheless, economic reasoning does a decent job of predicting the behavior of <em>systems</em>, and it’s been pretty interesting to learn how religion is no exception.</p>


    <div>
        <i class="fa fa-comment"></i> <a href="http://localhost:4000/2017/12/02/religions-as-firms/#disqus_thread" data-disqus-identifier="http://localhost:4000/2017/12/02/religions-as-firms/"></a>
        <span>&nbsp; &nbsp;</span>
        <span>
            <a class="twitter-share-button"
              href="https://twitter.com/share"
              data-url="http://localhost:4000/2017/12/02/religions-as-firms/"
              data-via="Chris_Said"
              data-count="none"
              data-text="Religions as firms">
            Tweet
            </a>
        </span>

    </div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2017/07/09/part-2-a-bipartisan-list-of-people-who-argue-in-good-faith/">
        Part 2&#58; A bipartisan list of people who argue in good faith
      </a>
    </h1>

    <span class="post-date">09 Jul 2017</span>

    <p>In <a href="/2017/07/09/part-1-a-bipartisan-list-of-people-who-are-bad-for-america/">Part 1</a>, I posted a bipartisan list of people who are bad for America. Those people present news stories that cherry pick the worst actions from the other side so that they can get higher TV ratings and more social media points.</p>

<p>Here in Part 2, I post a list of people who don’t do that, at least for the most part. This isn’t a list of centrists. If anything, it is a more politically diverse list than the list in Part 1. This is a list of people who usually make good-faith attempts to persuade others about their point of view.</p>

<ul>
  <li><strong>Megan McArdle</strong> (<a href="https://twitter.com/asymmetricinfo">Twitter</a>, <a href="https://www.bloomberg.com/view/contributors/AQjVOcPejrY/megan-mcardle">Bloomberg</a>) – Moderately libertarian ideas presented to a diverse audience</li>
  <li><strong>Noah Smith</strong> (<a href="https://twitter.com/Noahpinion">Twitter</a>, <a href="https://www.bloomberg.com/view/contributors/AR3OYuAmvcU/noah-smith">Bloomberg</a>) – Center-left economics</li>
  <li><strong>Ross Douthat</strong> (<a href="https://twitter.com/DouthatNYT">Twitter</a>, <a href="https://www.nytimes.com/column/ross-douthat">NYT</a>) – Social conservatism presented to a left-of-center audience</li>
  <li><strong>Noam Chomsky</strong> (<a href="https://chomsky.info/articles/">Website</a>)</li>
  <li><strong>Conor Friedersdorf</strong> (<a href="https://www.theatlantic.com/author/conor-friedersdorf">The Atlantic</a>)</li>
  <li><strong>Ben Sasse</strong> — Has the third-most conservative voting record in the Senate but never caricatures the other side and is very concerned about filter bubbles.</li>
  <li><strong>Julia Galef</strong> (<a href="https://twitter.com/juliagalef">Twitter</a>) – Has some <a href="https://twitter.com/juliagalef/status/850126407963262976">great advice</a> for understanding the other side</li>
  <li><strong>Nicky Case</strong> (<a href="https://twitter.com/ncasenmare">Twitter</a>)</li>
  <li><strong>Fareed Zakaria</strong> (<a href="https://www.washingtonpost.com/people/fareed-zakaria/">Washington Post</a>) – Center-left foreign policy</li>
  <li><strong>Eli Lake</strong> (<a href="https://twitter.com/EliLake">Twitter</a>, <a href="https://www.bloomberg.com/view/contributors/ASD1bG3hdiI/eli-lake">Bloomberg</a>) – Hawkish foreign policy</li>
  <li><strong>Kevin Drum</strong> (<a href="http://www.motherjones.com/kevin-drum/">Mother Jones</a>) – Center-left blogger who writes in good faith</li>
  <li><strong>John Carl Baker</strong> (<a href="https://twitter.com/johncarlbaker">Twitter</a>) – One of the few modern socialists I have found who avoids in-group snark.</li>
  <li><strong>Michael Dougherty</strong> (<a href="https://twitter.com/michaelbd">Twitter</a>, <a href="http://theweek.com/authors/michael-brendan-dougherty">The Week</a>)</li>
  <li><strong>Reihan Salam</strong> (<a href="https://twitter.com/reihan">Twitter</a>, <a href="http://www.nationalreview.com/author/reihan-salam">NRO</a>)</li>
  <li><strong>Avik Roy</strong> (<a href="https://twitter.com/Avik">Twitter</a>, <a href="http://www.nationalreview.com/author/avik-roy">NRO</a>) – Conservative health care</li>
  <li><strong>Ezra Klein</strong> (<a href="https://www.vox.com/authors/ezra-klein">Vox</a>, <a href="http://prospect.org/authors/ezra-klein">early days at the American Prospect</a>) – While at the American Prospect, Ezra did an amazing job trying to persuade people about the benefits of Obamacare. Vox, the explainer site that he started, sometimes slips into red meat clickbait. But to its credit, Vox has managed to reach a wide audience with mostly explainer content.</li>
</ul>

<p>Reading the people on this list with an open mind will broaden your worldview.</p>


    <div>
        <i class="fa fa-comment"></i> <a href="http://localhost:4000/2017/07/09/part-2-a-bipartisan-list-of-people-who-argue-in-good-faith/#disqus_thread" data-disqus-identifier="http://localhost:4000/2017/07/09/part-2-a-bipartisan-list-of-people-who-argue-in-good-faith/"></a>
        <span>&nbsp; &nbsp;</span>
        <span>
            <a class="twitter-share-button"
              href="https://twitter.com/share"
              data-url="http://localhost:4000/2017/07/09/part-2-a-bipartisan-list-of-people-who-argue-in-good-faith/"
              data-via="Chris_Said"
              data-count="none"
              data-text="Part 2&#58; A bipartisan list of people who argue in good faith">
            Tweet
            </a>
        </span>

    </div>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'csaid81'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script>

    </div>

  </body>
</html>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>


<script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>
