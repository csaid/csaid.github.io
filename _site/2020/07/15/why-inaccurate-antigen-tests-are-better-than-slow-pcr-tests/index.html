<!DOCTYPE html>
<html lang="en-us">

<!--
It's bad to import d3 in every post separately (https://groups.google.com/forum/#!topic/d3-js/bwdNirt2uEU).
Importing it globally here.
Putting this up at the top, according to this controversial stack overflow answer
http://stackoverflow.com/questions/7169370/d3-js-and-document-onready
 -->
<script src="https://d3js.org/d3.v5.min.js"></script>

<link rel="stylesheet" href="/public/font-awesome-4.4.0/css/font-awesome.min.css">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
    <meta name="description" content="For asymptomatic testing in schools and offices, speed matters more than sensitivity.">
  

  {$ if page.summary_large_image}
    <meta name="twitter:card" content="summary_large_image">

  <!-- To get a link preview image, just set the image attribute in your _post -->
  
    <meta content="http://localhost:4000/assets/2020_antigen_testing/fig_test_every_1_day.png" property="og:image"/>
  

  <!-- twitter standard -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@chris_said" />
  <meta name="twitter:title" content="Why low sensitivity antigen tests are better than slow PCR tests" />
  <meta name="twitter:description" content="For asymptomatic testing in schools and offices, speed matters more than sensitivity." />


  <title>
    
      Why low sensitivity antigen tests are better than slow PCR tests &middot; Chris Said
    
  </title>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-67746868-1', 'auto');
    ga('send', 'pageview');
  </script>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

<!--   <body class="theme-base-cps">
 -->
  <body>

    <div class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Chris Said
        </a>
      </h1>
      <p class="lead">I am a data scientist at Stitch Fix. This blog is mostly about statistics, technology, and science.</p>

    </div>

    <nav class="sidebar-nav">

      
        <a class="sidebar-nav-item" href="/">Home</a>
      
        <a class="sidebar-nav-item" href="/atom.xml">Feed</a>
      

    </nav>

    <div class="wrapper">
      <div class="inner">
        <a href = "http://www.twitter.com/Chris_Said" class="contact-button"><i class="fa fa-twitter fa-2x"></i></a>
        <a href = "https://www.linkedin.com/pub/chris-said/6b/86b/979" class="contact-button"><i class="fa fa-linkedin-square fa-2x"></i></a>
        <a href = "mailto:chris.said@gmail.com" class="contact-button"><i class="fa fa-envelope fa-2x"></i></a>
      </div>
    </div>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Why low sensitivity antigen tests are better than slow PCR tests</h1>
  <span class="post-date">15 Jul 2020</span>
  <p><em>UPDATE: After I posted this, I came across a recent preprint from <a href="https://www.medrxiv.org/content/10.1101/2020.06.22.20136309v2.full.pdf">Larremore et al.</a> that makes this point much better than I do. The preprint emphasizes that antigen tests have high sensitivity when viral load is high, corresponding to when people are contagious. See <a href="https://www.rapidtests.org/">rapidtests.org</a> for more info.</em></p>

<p>If we want to reopen schools and offices, we need to do so safely. According to Nobel Prize winning economist Paul Romer, the best way is with <a href="https://schools.paulromer.net/">frequent</a> and <a href="https://paulromer.net/faqs-on-virus-tests-in-schools/">regular</a> testing of asymptomatic students and employees. Catching infections early can stop the spread before it starts.</p>

<p>Much of the discussion about testing has centered on <a href="https://www.npr.org/sections/health-shots/2020/05/01/847368012/how-reliable-are-covid-19-tests-depends-which-one-you-mean">PCR</a>, a relatively expensive method that is vulnerable to <a href="https://www.npr.org/2020/05/28/863558750/coronavirus-testing-machines-are-latest-bottleneck-in-troubled-supply-chain">multiple</a> <a href="https://www.latimes.com/california/story/2020-07-12/california-fail-coronavirus-testing-covid-start">supply chain</a> bottlenecks and is generally <a href="https://www.technologyreview.com/2020/05/06/1001150/podcast-covid-19-testing-bottleneck/">hard to scale up</a>. Test samples must be sent to a central laboratory and then passed through expensive machines, a process that is currently taking 5-7 days, and in some places as high as <a href="https://twitter.com/SFCovidTestWait/status/1283122098714693633">10-13 days</a>. Efforts are being made to speed this up via pooling, but the operational complexity of PCR makes it likely that there will always be at least a few days of delay.</p>

<p>A less talked about alternative to PCR is called <em><a href="https://www.sciencemag.org/news/2020/05/coronavirus-antigen-tests-quick-and-cheap-too-often-wrong">antigen tests</a></em>. These tests are much cheaper than PCR, with estimates ranging between <a href="https://www.sciencemag.org/news/2020/05/coronavirus-antigen-tests-quick-and-cheap-too-often-wrong">$1</a> and <a href="https://www.technologyreview.com/2020/04/24/1000486/antigen-testing-could-faster-cheaper-diagnose-covid-19-coronavirus/">$10</a> per test, compared to <a href="https://www.technologyreview.com/2020/04/24/1000486/antigen-testing-could-faster-cheaper-diagnose-covid-19-coronavirus/">$50</a> for PCR. More importantly, they can return results in just <a href="https://www.cdc.gov/flu/professionals/diagnosis/clinician_guidance_ridt.htm">15 minutes</a>, without any need to send samples to a central lab.</p>

<p>Since antigen tests are far cheaper and faster than PCR, why are we not massively investing in them?</p>

<p>The usual answer is test sensitivity. SARS-CoV-2 antigen tests have a sensitivity of about <a href="https://www.nytimes.com/2020/07/06/health/fast-coronavirus-tests.html">85-90%</a>, meaning that only 85%-90% of true cases will be detected as such. And those are optimistic estimates reported by test manufacturers. For influenza, the CDC reports that antigen tests have a sensitivity of <a href="https://www.cdc.gov/flu/professionals/diagnosis/clinician_guidance_ridt.htm">50-70%</a>. This is much lower than PCR tests, which have a sensitivity as high at <a href="https://www.medrxiv.org/content/10.1101/2020.05.26.20112565v1.full.pdf">98%</a>.</p>

<p>Some doctors view the low sensitivity as an insurmountable hurdle. “It won’t work”, <a href="https://www.technologyreview.com/2020/04/24/1000486/antigen-testing-could-faster-cheaper-diagnose-covid-19-coronavirus/">said</a> one doctor. “A misdiagnosis is worse than no diagnosis”, <a href="https://www.sciencemag.org/news/2020/05/coronavirus-antigen-tests-quick-and-cheap-too-often-wrong">said</a> another.</p>

<p>I am not sure I agree, at least when it comes to mass testing of asymptomatic individuals. In this blog post I will show, via both simulations and analytical arguments, that the low sensitivity of antigen tests is a much better problem to have than the long delay of a PCR test.</p>

<h3 id="simulations">Simulations</h3>

<p>To test this hypothesis, I built an <a href="https://github.com/csaid/covid_model_with_testing/blob/master/SIR%20model%20with%20testing.ipynb">agent-based SIR model</a> that includes testing and quarantining. I make the following key assumptions:</p>

<ul>
  <li>Population of 200 students</li>
  <li>Using a rotation system, each student is tested once every K days.</li>
  <li>Students go into a 14 day quarantine if they get positive test results.</li>
  <li>In addition to intra-school infections, each student has a chance of getting infected by someone outside the population.</li>
</ul>

<p>I <a href="https://github.com/csaid/covid_model_with_testing/blob/master/SIR%20model%20with%20testing.ipynb">simulated</a> two different scenarios.</p>

<ul>
  <li>Regular PCR testing (sensitivity of 98%, testing delay of 5 days)</li>
  <li>Regular antigen testing (sensitivity of 75%, no testing delay)</li>
</ul>

<p>For comparison, I also modeled a “best case scenario”, where no intra-school infections occur, and a “worst case scenario”, where there is no testing or quarantining at all.</p>

<p>Assuming that each student is tested once every 4 days, I find that the cumulative number of infections is far lower if we do regular antigen testing than if we do regular PCR testing.</p>

<p><img src="/assets/2020_antigen_testing/fig_test_every_4_days.png" /></p>

<p>If we change the frequency of testing to once every day, antigen testing is able to achieve close to best case results, with almost no intra-school infections. Meanwhile, daily PCR testing still results in a large number of infections.</p>

<p><img src="/assets/2020_antigen_testing/fig_test_every_1_day.png" /></p>

<p>This seems very important. <em>Not only are antigen tests cheaper than PCR, they are also more effective in a mass testing regime.</em> Further simulations in my <a href="https://github.com/csaid/covid_model_with_testing/blob/master/SIR%20model%20with%20testing.ipynb">notebook</a> show that the superiority of antigen tests is maintained even for much lower sensitivities.</p>

<h3 id="why-is-low-sensitivity-better-than-slowness">Why is low sensitivity better than slowness?</h3>

<p>Maybe you don’t believe my simulations, so here’s an analytical argument instead. Imagine you test people every day using a 75% sensitive antigen test. If someone is infected, they will probably find out immediately. There is a smallish chance they will first find out after a day, and a very small chance it will take longer than that. On average they will find out after 0.33 days, which is much faster than a typical PCR test. In general, for a sensitivity of \(s\), daily antigen test participants will find out after an average of \(d\) days, where \(d\) is defined as:</p>

\[d = \sum_{t=0}^{\infty}{(1-s)^t s t}\]

<p>which converges to</p>

\[d = \frac{1-s}{s}\]

<p>For any reasonable value of \(s\), \(d\) will be quite low. Here’s a striking example. If you test people every day, a test with 50% sensitivity and no delay is equivalent to a test with 100% sensitivity and a 1-day delay!</p>

<p>This analysis assumes that \(s\) is fixed across time and individuals, an assumption I’ll address in the FAQ, below.</p>

<h3 id="faq">FAQ:</h3>

<p><strong>Q:</strong> <em>What is your main conclusion from this analysis?</em>
<br /> <strong>A:</strong> For mass testing of asymptomatic individuals in schools and offices, antigen tests are cheaper and more effective than PCR tests.</p>

<p><strong>Q:</strong> <em>Have other people come to this conclusion?</em>
<br /> <strong>A:</strong> Yes. After writing this blog post, I came across two recent pre-prints.</p>
<ul>
  <li><a href="https://www.medrxiv.org/content/10.1101/2020.06.22.20136309v2.full.pdf">Larremore et al.</a> shows that sensitivity is less important than testing delays. It comes with a wonderful <a href="https://larremorelab.github.io/covid-calculator3">interactive calculator</a>.</li>
  <li><a href="https://www.medrxiv.org/content/10.1101/2020.07.06.20147702v1.full.pdf">Paltiel et al.</a> show that sensitivity is less important than test frequency.</li>
</ul>

<p><strong>Q:</strong> <em>Are you arguing that antigen tests should always replace PCR?</em>
<br /> <strong>A:</strong> No, I’m only suggesting it for mass testing of asymptomatic individuals. If a symptomatic person comes into a doctor’s office a PCR test would make sense, since sensitivity becomes more important and cost becomes less important.</p>

<p><strong>Q:</strong> <em>What if the antigen test has a much lower sensitivity for certain individuals, who will therefore remain undetected?</em>
<br /> <strong>A:</strong> Low sensitivity for these individuals is <a href="https://www.sciencedirect.com/science/article/abs/pii/S138665321000106X">likely due to low viral load</a>, which most researchers believe means they will not be very infectious. That said, if would be really good if we could get more research on this, since it’s an important question.</p>

<p><strong>Q:</strong> <em>What if the sensitivity of the antigen test is especially low at the start of infection?</em>
<br /> <strong>A:</strong> Another good question. As with the previous answer, this period of low sensitivity would likely be to due low viral load, when the individual is less infectious. Furthermore, the period where PCR tests can detect the virus while antigen tests cannot is <a href="https://www.medrxiv.org/content/10.1101/2020.06.22.20136309v2.full.pdf">probably only 24 hours</a>. But <em>even if</em> we assume the individual is just as infectious during this early period, the antigen test still remains superior. To estimate this, I ran simulations where antigen tests were completely ineffective for the first two days of infection, a conservative assumption. Even with this conservative constraint, and even assuming the individuals are fully infectious during this period, antigen tests still outperformed PCR.</p>

<p><img src="/assets/2020_antigen_testing/fig_test_every_1_day_delayed_detection.png" /></p>

<p><strong>Q:</strong> <em>What if the false negatives cause riskier behavior?</em>
<br /> <strong>A:</strong> It’s possible that people might exhibit more risk after a false negative antigen test than after taking a PCR test and having to wait. However, this risk can be minimized by (a) educating people about sensitivity and (b) pairing the testing regime with other measures like masks and social distancing.</p>

<p><strong>Q:</strong> <em>Do antigen tests require those invasive pharyngeal swabs that go deep up your nose?</em>
<br /> <strong>A:</strong> Not necessarily. While <a href="https://www.nytimes.com/2020/05/09/health/antigen-testing-fda-coronavirus.html">Quidel</a> and <a href="https://www.nytimes.com/reuters/2020/07/06/us/06reuters-health-coronavirus-becton-dickinson.html">Becton Dickinson</a> are producing pharyngeal swab antigen tests, another company called <a href="https://www.inquirer.com/news/spit-test-covid-coronavirus-orasure-fda-hiv--20200706.html">OraSure</a> is producing a saliva test. Will a saliva test be as accurate as a pharyngeal swab test? The evidence is mixed, with some studies suggesting it will be less accurate and others suggesting it will be more accurate (<a href="https://www.medrxiv.org/content/10.1101/2020.04.16.20067835v1">1</a>, <a href="https://www.medrxiv.org/content/10.1101/2020.05.26.20112565v1.full.pdf">2</a>, <a href="https://jcm.asm.org/content/jcm/55/1/226.full.pdf">3</a>).</p>

<p><strong>Q:</strong> <em>I heard that <a href="https://m.canadianinsider.com/sona-nanotech-announces-validation-results-for-its-covid-19-antigen-test">SONA</a> has an antigen test with 96% sensitivity. This sounds super promising!</em>
<br /> <strong>A:</strong> This statistic is a bit misleading. The positive samples were generated in a laboratory. When antigen tests are done in real world clinical settings, the sensitivity is <a href="https://www.technologyreview.com/2020/04/24/1000486/antigen-testing-could-faster-cheaper-diagnose-covid-19-coronavirus/">lower</a>.</p>

<p><strong>Q:</strong> <em>Will we ever get a test that is both fast and sensitive?</em>
<br /> <strong>A:</strong> The New York Times had a great <a href="https://www.nytimes.com/2020/07/06/health/fast-coronavirus-tests.html">article</a> last week on new types of point-of-care tests that are being developed, including <a href="https://www.medrxiv.org/content/10.1101/2020.06.13.20129841v1.full.pdf">HP-LAMP</a> and <a href="https://www.biorxiv.org/content/10.1101/2020.05.28.119131v1.full.pdf">SHINE</a>. These seem promising, although they are in an earlier stage of development than antigen tests, which already have several companies producing tests.</p>

<hr />
<p>A special thanks to <a href="https://twitter.com/antonioregalado">Antonio Regalado</a> and <a href="https://path.upmc.edu/personnel/faculty/Wells.htm">Alan Wells</a> for help answering some questions during my research.</p>

  <div>
    <a class="twitter-share-button"
      href="https://twitter.com/share"
      data-url=""
      data-via="Chris_Said"
      data-size="large"
      data-count="none">
    Tweet
    </a>
</div>

  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'csaid81';
    var disqus_identifier = 'http://localhost:4000/2020/07/15/why-inaccurate-antigen-tests-are-better-than-slow-pcr-tests/';
    var disqus_url = 'http://localhost:4000/2020/07/15/why-inaccurate-antigen-tests-are-better-than-slow-pcr-tests/';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>


    </div>

  </body>
</html>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>
